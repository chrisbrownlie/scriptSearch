#' @title Script R6 class
#' 
#' @name Script
#' 
#' @description R6 class for storing information about a script
#' and methods for analysing the text
#' 
#' @return returns an R6 object of class Script
#' 
#' @import cli
#' @rawNamespace import(crayon, except = c("num_ansi_colors"))
#' 
#' @export
Script <- R6::R6Class(
  classname = "Script",
  
  # Public
  public = list(
    # Public - fields -----
    #' @field path The file path to the script
    path = NULL,
    
    #' @field name The title of the script/play
    name = NULL,
    
    #' @field raw_text The raw, unaltered text extracted from the file
    raw_text = NULL,
    
    #' @field text_df The raw text, formatted as a dataframe with one
    #' row per line
    text_df = NULL,
    
    # Public - methods -----
    #' @description Initialise a new Script object
    #' 
    #' @param path The file path to the script
    #' @param title (optional) the title of the script
    #' 
    #' @return an R6 object with class Script
    initialize = function(path,
                          title) {
      
      self$raw_text <- readtext::readtext(path)$text
      
      self$text_df <- import_script(path)
      
      if (!missing(title)) self$name <- title
    },
    
    #' @description Print info about script
    print = function() {
      cat_rule(cyan("Script object"))
      cat_line()
      cat_boxx(label = ifelse(length(self$name),
                               self$name,
                               "Unnamed Script"))
    },
    
    
    #' @description Search for a string and return lines that match the string
    #' 
    #' @param string the string to search for
    #' 
    #' @return a subset of the text_df dataframe with matching lines
    search = function(string) {
      
    }
  ),
  
  # Private fields and methods
  private = list()
)